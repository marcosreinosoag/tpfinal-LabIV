<div class="hero-background">
  <nav class="navbar-clinica">
    <div class="logo">
      <img src="assets/images/icono.ico" alt="ClÃ­nica" />
      <div class="titulo-logo">
        <h2>{{ translate('welcome.clinicName') }}</h2>
        <span>{{ translate('welcome.specialists') }}</span>
      </div>
    </div>
    <ul class="navbar-links">
      <li>
        <div class="language-selector">
          <select [(ngModel)]="currentLanguage" (change)="changeLanguage(currentLanguage)" class="language-select">
            <option *ngFor="let lang of languages" [value]="lang.code">{{ lang.name }}</option>
          </select>
        </div>
      </li>
    </ul>
  </nav>

  <div *ngIf="!isRoleSelected" class="selector-contenedor">
    <h2>{{ translate('register.selectUserType') }}</h2>
    <div class="selector-opciones">
      <button (click)="selectRole('Paciente')" class="card-opcion">
        <img src="/assets/images/paciente.png" [alt]="translate('register.patient')" />
        <span>{{ translate('register.patient') }}</span>
      </button>
      <button (click)="selectRole('Especialista')" class="card-opcion">
        <img src="/assets/images/medico.jpg" [alt]="translate('register.specialist')" />
        <span>{{ translate('register.specialist') }}</span>
      </button>
    </div>
  </div>

  <div *ngIf="isRoleSelected" class="form-container">
    <h2>{{ translate('register.title') }} {{ selectedRole === 'Paciente' ? translate('register.patient') : translate('register.specialist') }}</h2>
    <form [formGroup]="selectedRole === 'Paciente' ? formPaciente : formEspecialista" (ngSubmit)="onSubmit()">

      <div class="row">
        <div>
          <label for="nombre">{{ translate('register.name') }}</label>
          <input id="nombre" formControlName="nombre" type="text" appAutoFocus />
          <small *ngIf="nombre?.invalid && nombre?.touched">{{ mensajeError('nombre') }}</small>
        </div>
        <div>
          <label for="apellido">{{ translate('register.lastName') }}</label>
          <input id="apellido" formControlName="apellido" type="text" />
          <small *ngIf="apellido?.invalid && apellido?.touched">{{ mensajeError('apellido') }}</small>
        </div>
      </div>

      <div class="row">
        <div>
          <label for="edad">{{ translate('register.age') }}</label>
          <input id="edad" formControlName="edad" type="number" />
          <small *ngIf="edad?.invalid && edad?.touched">{{ mensajeError('edad') }}</small>
        </div>
        <div>
          <label for="dni">{{ translate('register.dni') }}</label>
          <input id="dni" formControlName="dni" type="text" />
          <small *ngIf="dni?.invalid && dni?.touched">{{ mensajeError('dni') }}</small>
        </div>
      </div>

      <label for="mail">{{ translate('register.email') }}</label>
      <input id="mail" formControlName="mail" type="email" />
      <small *ngIf="mail?.invalid && mail?.touched">{{ mensajeError('mail') }}</small>

      <label for="password">{{ translate('register.password') }}</label>
      <div style="display: flex; align-items: center; gap: 0.5rem;">
        <input id="password" formControlName="password" type="password" />
        <button type="button" appMostrarPassword style="border: none; background: none; cursor: pointer;">ğŸ‘ï¸</button>
      </div>
      <small *ngIf="password?.invalid && password?.touched">
        {{ mensajeError('password') }}
      </small>

      <div *ngIf="selectedRole === 'Paciente'">
        <label for="obraSocial">{{ translate('register.healthInsurance') }}</label>
        <input id="obraSocial" formControlName="obraSocial" type="text" />
        <small *ngIf="obraSocial?.invalid && obraSocial?.touched">{{ mensajeError('obraSocial') }}</small>

        <label for="fotoPerfil1">{{ translate('register.profilePhoto1') }}</label>
        <input type="file" (change)="onFileChange($event, 1)" id="fotoPerfil1" />

        <label for="fotoPerfil2">{{ translate('register.profilePhoto2') }}</label>
        <input type="file" (change)="onFileChange($event, 2)" id="fotoPerfil2" />
      </div>

      <div *ngIf="selectedRole === 'Especialista'">
        <label>{{ translate('register.specialties') }}</label>
        <div *ngFor="let especialidad of especialidades">
          <input type="checkbox" [value]="especialidad" (change)="onEspecialidadChange($event)" /> {{ especialidad }}
        </div>
        <small *ngIf="formEspecialista.get('especialidades')?.errors?.['required'] && formEspecialista.touched">
          {{ translate('register.error.specialtyRequired') }}
        </small>

        <input type="text" #nuevaEspecialidad [placeholder]="translate('register.addSpecialty')" />
        <button type="button" class="add-button"
          (click)="agregarEspecialidad(nuevaEspecialidad.value); nuevaEspecialidad.value=''">
          {{ translate('register.add') }}
        </button>

        <label for="fotoPerfil">{{ translate('register.profilePhoto') }}</label>
        <input type="file" (change)="onFileChange($event, 1)" id="fotoPerfil" />
      </div>

      <div appToggleCaptchaButton (estadoCambiado)="captchaHabilitado = $event" class="captcha-container"></div>
      <div id="captcha-container" *ngIf="captchaHabilitado"></div>

      <button type="submit"
        [disabled]="
          enviando ||
          (selectedRole === 'Paciente' ? formPaciente.invalid : formEspecialista.invalid)
        ">
        <ng-container *ngIf="!enviando">{{ translate('register.submit') }}</ng-container>
        <ng-container *ngIf="enviando">
          <span class="spinner"></span> {{ translate('register.registering') }}
        </ng-container>
      </button>
    </form>
  </div>
</div>